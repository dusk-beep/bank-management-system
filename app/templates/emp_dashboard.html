<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Dashboard</title>
  <style>
    .hidden {
      display: none;
    }

    .form-container {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
      background: #f9f9f9;
    }

    .success {
      color: green;
    }

    .error {
      color: red;
    }
  </style>
</head>

<body>
  <div class="logo">My Bank</div>
  <div>
    <button id="create-account">Create Account</button>
  </div>

  <div class="container">
    <div id="form-container" class="hidden form-container">
      <h2>Create Account</h2>
      <form id="account-form">
        <h3>User Info</h3>
        <label for="name">Name:</label>
        <input type="text" id="name" required><br><br>
        <label for="email">Email:</label>
        <input type="email" id="email" required><br><br>
        <label for="password">Password:</label>
        <input type="password" id="password" required><br><br>

        <h3>Account Info</h3>
        <label for="acc-type">Account Type</label>
        <select id="create-select">
          <option value="savings">Savings</option>
          <option value="current">Current</option>
        </select>
        <br><br>
        <label for="balance">Balance:</label>
        <input type="number" id="balance" required min="0"><br><br>
        <button type="submit">Submit</button>
      </form>
      <div id="message"></div>
    </div>
  </div>

  <script>
    document.getElementById("create-account").addEventListener("click", function () {
      document.getElementById("form-container").classList.toggle("hidden");
    });

    document.getElementById("account-form").addEventListener("submit", async function (event) {
      event.preventDefault();
      const name = document.getElementById("name").value;
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const select = document.getElementById("create-select").value;
      const balance = document.getElementById("balance").value;

      const messageDiv = document.getElementById('message');
      messageDiv.innerHTML = ''; // Clear previous messages

      try {
        const response = await fetch(`/create_account`, { // Change to your server endpoint
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            cust_name: name,
            cust_email: email,
            password: password,
            acc_type: select,
            balance: balance,
          }),
        });

        const data = await response.json();

        if (response.ok) {
          messageDiv.innerHTML = `<p class="success">${data.message}</p>`;
        } else {
          throw new Error(data.error || 'An error occurred');
        }
      } catch (error) {
        messageDiv.innerHTML = `<p class="error">Failed to create account. ${error.message}</p>`;
      }
    });

    document.getElementById("account-form").reset();
    document.getElementById("form-container").classList.add("hidden");
  </script>
</body>

</html>
